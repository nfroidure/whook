[//]: # ( )
[//]: # (This file is automatically generated by a `metapak`)
[//]: # (module. Do not change it  except between the)
[//]: # (`content:start/end` flags, your changes would)
[//]: # (be overridden.)
[//]: # ( )
# @whook/swagger-ui
> A wrapper for the Whook HTTP Router to provide SwaggerUI for local dev

[![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)](https://github.com/nfroidure/whook/blob/main/packages/whook-swagger-ui/LICENSE)


[//]: # (::contents:start)

This module provides the GraphIQL UI to your local
[Whook](https://github.com/nfroidure/whook) server !

## Usage

The `DEV_MODE=1` environment variable must be used when starting your server
(`npm run dev` does it by default).

## Setup

Install the module:

```sh
npm i @whook/swagger-ui
```

To use it, just wrap the HTTP router with this module and override its
registration with the `Knifecycle` instance inside the `runServer` function
(usually in `src/index.ts`):

```diff
+ import initHTTPRouter from '@whook/http-router';
+ import wrapHTTPRouterWithSwaggerUI from '@whook/swagger-ui';

// (...)

// It is important to do this in the runServer function since it really
//  make sense only when actually running the server
export async function runServer(injectedNames = [], $ = new Knifecycle()) {

  // (...)

+   // Add support for Swagger UI by wrapping and
+  //  overriding the original HTTP Router
+   $.register(
+     wrapHTTPRouterWithSwaggerUI(initHTTPRouter),
+   );

  return await runBaseServer(injectedNames, $);
}
```

Declare this module types in your `src/whook.d.ts` type definitions:

```diff
+import type {
+   WhookSwaggerUIEnv,
+   WhookAPIOperationSwaggerConfig,
+   WhookSwaggerUIConfig,
+} from '@whook/swagger-ui';

declare module '@whook/whook' {

  export interface WhookEnv
    extends WhookBaseEnv,
    // (...)
+      WhookGraphIQLEnv,
      WhookSwaggerUIEnv {}

  // ...

  export interface WhookConfigs
-    extends WhookBaseConfigs {}
+    extends WhookBaseConfigs, WhookSwaggerUIConfig {}

  // ...

  export interface WhookAPIHandlerDefinition<
    T extends Record<string, unknown> = Record<string, unknown>,
    U extends {
      [K in keyof U]: K extends `x-${string}` ? Record<string, unknown> : never;
    } = unknown,
    V extends Record<string, unknown> = Record<string, unknown>,
  > extends WhookBaseAPIHandlerDefinition<T, U> {
    operation: U & WhookAPIOperation<
        T &
+      WhookAPIOperationSwaggerConfig &
      WhookAPIOperationCORSConfig
    >;
  }

}
```

And add the SwaggerUI config (usually in `src/config/common/config.js`):

```diff
import type { WhookConfigs } from '@whook/whook';

const CONFIG: WhookConfigs = {
  // ...
  BASE_PATH: 'v4',
};


export default CONFIG;
```

[//]: # (::contents:end)

# API

# Authors
- [Nicolas Froidure](http://insertafter.com/en/index.html)

# License
[MIT](https://github.com/nfroidure/whook/blob/main/packages/whook-swagger-ui/LICENSE)
